Index: os-systemd/src/resolve/resolved-dnstls-openssl.c
===================================================================
--- os-systemd.orig/src/resolve/resolved-dnstls-openssl.c
+++ os-systemd/src/resolve/resolved-dnstls-openssl.c
@@ -392,8 +392,10 @@ int dnstls_manager_init(Manager *manager
 
         assert(manager);
 
+#if OPENSSL_VERSION_NUMBER < 0x30000000L
         ERR_load_crypto_strings();
         SSL_load_error_strings();
+#endif
 
         manager->dnstls_data.ctx = SSL_CTX_new(TLS_client_method());
         if (!manager->dnstls_data.ctx)
Index: os-systemd/src/resolve/resolved-dns-dnssec.c
===================================================================
--- os-systemd.orig/src/resolve/resolved-dns-dnssec.c
+++ os-systemd/src/resolve/resolved-dns-dnssec.c
@@ -14,6 +14,7 @@
 #include "string-table.h"
 
 #if PREFER_OPENSSL
+#include "openssl/rsa.h"
 #  pragma GCC diagnostic push
 #    pragma GCC diagnostic ignored "-Wdeprecated-declarations"
 DEFINE_TRIVIAL_CLEANUP_FUNC_FULL(RSA*, RSA_free, NULL);
Index: os-systemd/src/shared/openssl-util.c
===================================================================
--- os-systemd.orig/src/shared/openssl-util.c
+++ os-systemd/src/shared/openssl-util.c
@@ -3,6 +3,7 @@
 #include "openssl-util.h"
 #include "alloc-util.h"
 #include "hexdecoct.h"
+#include "openssl/rsa.h"
 
 #if HAVE_OPENSSL
 int openssl_hash(const EVP_MD *alg,
